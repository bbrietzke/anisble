#cloud-config
autoinstall:
  version: 1
  identity:
    hostname: titan
    username: bbrietzke
    password: "$5$r3Kl6AKBqjA78VCX$4.Vuc56PR2faX3vLuqBxHxF796qiLhxuS4MacXtTt5C" 
  locale: en_US
  storage:
      layout:
        name: lvm
      swap:
        size: 0
      config:
        - grub_device: true
          id: disk0
          path: /dev/sda
          ptable: gpt
          type: disk
          wipe: superblock-recursive
        - device: disk0
          flag: bios_grub
          id: disk0-part0
          size: 1MB
          type: partition
        - device: disk0
          id: disk0-part1
          size: 20G
          type: partition
        - device: disk0
          id: disk0-part2
          size: -1
          type: partition
        - type: lvm_volgroup
          id: vg0
          name: vg0
          devices:
            - disk0-part1
        - type: lvm_partition
          id: lvm_part0
          name: root-partition
          volgroup: vg0
          size: 100%
        - type: format
          id: lvm_part0_root_fs
          fstype: ext4
          label: root
          volume: lvm_part0
        - type: mount
          id: lvm_part0_root_fs_mount
          path: /
          device: lvm_part0_root_fs
  ssh:
    install-server: true
    allow-pw: no
    authorized-keys:
      - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDJCmIDVTvXpMAhGJnJZvB2ZVMV/3lBHqAWmzXLTugwx8l7b22N2fyL6Wunl2CMJ71evQD5JKfIeQp4u5HI3qirgzBWiTK7FUfX5jZ+RU4Uwarmkfv/I4KkyB8SfM9C1A+RPJRl7Ir2fUS2VzQqj6NGXo4OKraXxSSWKzSWMIDJQjdr1L0wZ/x4ExTdeWc3eXyFl3nUATvRGXBu9ikYsCvKl0+kpfmdWTSyO5rWdRaVtidZeqjo1LC4jqySzJagWJSF+G6z9mBIMwI+18jjZwM+6TAZNh44qdfkyGUzto0jA1Z3LF+Jrpsisr9XUCOUD7uli/pBTd6vv+VYMC9jNKpZXbEhLkmi34aDo7wuiIIeFj94+Xn2mNJw6/rlDfA8p9DEBeCsRNXajqpptvEUKAYDs3YXY4VrETFUnz6RZGn4WdfyrKNqg3Q+3OIcMS/EbqYt7pvAVUAR3rD9ZvHfyjR7E3xpF9TuvOxBznBjWf3rLtjBdrUVxmyjHRJdDiTMcPk= bbrietzke@jupiter.lan
  shutdown: poweroff
  user-data:
    chpasswd:
      expire: true
      users:
        - name: bbrietzke
          password: bbrietzke
          type: text
    package_reboot_if_required: true
    ## Install additional packages on first boot
    packages:
      - screen
      - zsh
    users:
      - name: bbrietzke
        gecos: Brian Brietzke
        ssh_import_id: 
          - gh:bbrietzke
        plain_text_passwd: bbrietzke
        sudo: ALL=(ALL) NOPASSWD:ALL
        shell: /bin/zsh
        groups: users,admin,wheel
      - name: ansible
        gecos: Ansible Remote Administrator
        ssh_import_id:
          - gh:bbrietzke
        plain_text_passwd: HN8wOK3VzXSE37bfa7jZBikDFh5l19c4eou5qC0JAJ6YYuXQze
        sudo: ALL=(ALL) NOPASSWD:ALL
        shell: /bin/bash
        groups: users,admin,wheel